Object.extend(Ajax.InPlaceEditor.prototype,{handleAJAXFailure:function(a){this.triggerCallback("onFailure",a);if(this._oldInnerHTML){this.element.innerHTML=this._oldInnerHTML;this._oldInnerHTML=null}this.leaveEditMode()}});Object.extend(Ajax.InPlaceEditor.DefaultCallbacks,{onFailure:function(b,a){alert("Error communication with the server: "+a.responseText.stripTags())}});Object.extend(Ajax.InPlaceEditor.prototype,{initialize:function(c,b,a){this.url=b;this.element=c=$(c);this.prepareOptions();this._controls={};arguments.callee.dealWithDeprecatedOptions(a);Object.extend(this.options,a||{});if(!this.options.formId&&this.element.id){this.options.formId=this.element.id+"-inplaceeditor";if($(this.options.formId)){this.options.formId=""}}if(this.options.externalControl){this.options.externalControl=$(this.options.externalControl)}if(!this.options.externalControl){this.options.externalControlOnly=false}this._originalBackground=this.element.getStyle("background-color")||"transparent";this.element.title=this.options.clickToEditText;this._boundCancelHandler=this.handleFormCancellation.bind(this);this._boundComplete=(this.options.onComplete||Prototype.emptyFunction).bind(this);this._boundFailureHandler=this.handleAJAXFailure.bind(this);this._boundSubmitHandler=this.handleFormSubmission.bind(this);this._boundWrapperHandler=this.wrapUp.bind(this);this.registerListeners();if(this.options.editOnBlank&&this.getText().length==0){this.enterEditMode()}},handleAJAXFailure:function(a){this.triggerCallback("onFailure",a);this.element.innerHTML=this._oldInnerHTML;this._oldInnerHTML=null;this.leaveEditMode()},wrapUp:function(a){this.leaveEditMode();if(this.options.editOnBlank&&this.getText().length==0){this.enterEditMode()}this._boundComplete(a,this.element)}});Object.extend(Ajax.InPlaceEditor.DefaultOptions,{editOnBlank:true});Ajax.InPlaceEditor.prototype.initialize.dealWithDeprecatedOptions=function(a){if(!a){return}function b(c,d){if(c in a||d===undefined){return}a[c]=d}b("cancelControl",(a.cancelLink?"link":(a.cancelButton?"button":a.cancelLink==a.cancelButton==false?false:undefined)));b("okControl",(a.okLink?"link":(a.okButton?"button":a.okLink==a.okButton==false?false:undefined)));b("highlightColor",a.highlightcolor);b("highlightEndColor",a.highlightendcolor)};